code is very messy and stupid but hey it work!(most of the time at least)
